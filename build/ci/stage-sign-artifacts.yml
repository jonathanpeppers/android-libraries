# Signs artifacts on tags built for release
  
stages:
- stage: sign_artifacts
  displayName: Sign Artifacts
  dependsOn: build_windows
  condition: succeeded()
  
  jobs:
  
  - template: sign-artifacts/jobs/v4.yml@yaml-templates
    parameters:
      timeoutInMinutes: 180
      artifactName: output-windows
      usePipelineArtifactTasks: true
      checkoutType: self
      ${{ if and(startsWith(variables['Build.SourceBranch'], 'refs/heads/release/'), not(eq(variables['Build.Reason'], 'PullRequest'))) }}:
        signType: Real
      ${{ else }}:
        signType: Test
